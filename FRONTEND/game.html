<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <title>PICO</title>
    <link rel="stylesheet" href="main_loan_style.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.6.0/css/all.min.css" integrity="sha512-Kc323vGBEqzTmouAECnVceyQqyqdsSiqLQISBL29aUW4U/M7pSPA/gEUZQqv1cwx4OnYxTxve5UMg5GT6L4JJg==" crossorigin="anonymous" referrerpolicy="no-referrer" />
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
</head>
<body>
    
    <div class="container">
        <header>
            <h1><i class="fa-solid fa-piggy-bank"></i> PICO BANK</h1>
        </header>

        <main>

 <!-- Savings Account Section -->
 <section class="account-info">
    <h2>Savings</h2>
    <p id="savingsAccountNumber">Account No: <i class="fa-solid fa-spinner fa-spin"></i></p>
    <p id="savingsAmount">â‚©<i class="fa-solid fa-spinner fa-spin"></i></p>
</section>

    <div class="chart-container">
        <canvas id="myBarChart" width="400" height="500"></canvas>
    </div>

    <script>
        document.addEventListener("DOMContentLoaded", function() {
            // Get the canvas element and its 2D drawing context
            const canvas = document.getElementById('myBarChart');
            const ctx = canvas.getContext('2d');

            const chartWidth = canvas.width;
            const chartHeight = canvas.height;
            const barHeight = 30;
            const barSpacing = 10;
            const maxBarWidth = chartWidth - 120; // Leave space for labels
            
            // Function to draw a horizontal bar
            function drawBar(x, y, width, height, color, label) {
                ctx.fillStyle = color;
                ctx.fillRect(x, y, width, height);
    
                ctx.fillStyle = 'black';
                ctx.font = '14px Arial';
                ctx.fillText(label, x - 80, y + height / 2 + 4); // Label position
            }

            const apiUrl = 'http://100.84.157.44:19200/api/v1/user/leaderboard'; // Replace with your actual API endpoint
        
                        // Fetch user data and savings
                        fetch(apiUrl, {
                            method: 'GET',
                            headers: {
                                'Content-Type': 'application/json'
                            }
                        })
                        .then(response => response.json())
                        .then(data => {
                            console.log(data.rank);
                            const maxValue = data.rank[0];
                            const contentDiv = document.getElementsByClassName('leaderboard')[0];
                            for (let i = 0; i < 10; i++){
                                const barWidth = (data.rank[i] / maxValue) * maxBarWidth;
                                const x = 100; // Start x position for bars
                                const y = i * (barHeight + barSpacing) + 20; // Start y position for bars
                                const color = 'rgba(75, 192, 192, 0.8)'; // Bar color
                    
                                drawBar(x, y, barWidth, barHeight, color, data.rank[i]);
                            }
                        })
                        .catch(error => {
                            console.error('Error fetching the leaderboard data:', error);
                        });
    
            // Draw axes and labels
            //ctx.strokeStyle = 'black';
            //ctx.lineWidth = 1;
            //ctx.beginPath();
            //ctx.moveTo(80, 10);
        });
    </script>
    

            <div class="leaderboard" style="height: 150%; margin:7%">
                <h2 style="text-align: center; color:#6200ea">Leaderboard</h1>
                <h4 style="text-align: center;">Month: August</h4>
                </div>
                <script>
                    document.addEventListener("DOMContentLoaded", function() {
                        const apiUrl = 'http://100.84.157.44:19200/api/v1/user/leaderboard'; // Replace with your actual API endpoint
        
                        // Fetch user data and savings
                        fetch(apiUrl, {
                            method: 'GET',
                            headers: {
                                'Content-Type': 'application/json'
                            }
                        })
                        .then(response => response.json())
                        .then(data => {
                            const contentDiv = document.getElementsByClassName('leaderboard')[0];
                            for (let i = 0; i < 10; i++){
                                contentDiv.innerHTML += `<div class="history-item"><p>${i + 1}. ${data.rank[i]}</p></div>`;
                            }
                        })
                        .catch(error => {
                            console.error('Error fetching the leaderboard data:', error);
                        });
                    });
                </script>

        </main>
    </div>

    <!-- Bottom Menu -->
    <nav class="bottom-menu">
        <button class="menu-button" title="Loan" id="loanButton"><i class="fa-solid fa-handshake-simple"></i></button>
        <button class="menu-button" title="Home" id="homeButton"><i class="fa fa-home"></i></button>
        <button class="menu-button" title="Game" id="gameButton"><i class="fa-solid fa-square-poll-horizontal"></i></button>
        <button class="menu-button" title="Settings" id="settingsButton"><i class="fa fa-bars"></i></button>
    </nav>

    <script src="app.js"></script>
    <script src="game.js"></script>
</body>
</html>
